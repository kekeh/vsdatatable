/* 
*  Name: vsdatatable 
*  Description: Simple single page datatable - AngularJS reusable UI component 
*  Version: 0.1.5 
*  Author: kekeh 
*  Homepage: http://kekeh.github.io/vsdatatable 
*  License: MIT 
*  Date: 2015-08-29 
*/ 
angular.module('template-vsdatatable-0.1.5.html', []).run(['$templateCache', function($templateCache) {
  $templateCache.put("templates/vsdatatable.html",
    "<div class=vsdatatable ng-style=\"{'pointer-events':busyIcon?'none':'auto'}\"><div ng-if=options.busyIcon.visible ng-include=\"'templates/vsdtbusyicon.html'\"></div><div ng-style=\"{'opacity':busyIcon?'0.4':'1'}\"><div caption-bar></div><table class=tableRows><thead class=tableHeader ng-if=options.headerVisible><tr class=headerRow><th style=position:static class=\"headerCol textOverflow\" col-resizer ng-if=\"h.visible===undefined||h.visible\" ng-style=\"{'width':h.width.number+h.width.unit, 'cursor':h.sorting?'pointer':'default'}\" ng-class=\"sort.col===h.prop&&h.sorting?'selectedHeaderCol':''\" ng-repeat=\"h in options.columns\" ng-click=h.sorting?sortByCol($event,h.prop):null ng-keydown=h.sorting?sortByCol($event,h.prop):null>{{h.label}} <span class=\"icon sortColIcon\" ng-if=h.sorting ng-class=\"{'selectedHeaderCol':sort.col===h.prop&&h.sorting, 'icon-sort':h.sorting&&sort.col!==h.prop, 'icon-down':sort.col===h.prop&&sort.reverse, 'icon-up':sort.col===h.prop&&!sort.reverse}\" tabindex=0></span> <span class=\"icon icon-cross sortColIcon\" ng-if=\"h.sorting&&sort.col===h.prop\" ng-click=\"sortByCol($event,'')\" ng-keydown=\"sortByCol($event,'')\" tabindex=0></span></th><th id=headerColAction class=\"headerCol headerColAction\" ng-if=options.useTemplates ng-style=\"{'width': config.DEFAULT_ACTION_COL_WIDTH + 'px'}\"><span>{{options.actionColumnText}}</span> <span class=\"icon icon-plus actionIcon addItemIcon\" ng-if=options.templates.add.actionBtnShow ng-click=addRow(); ng-keydown=checkEvent($event)?addRow():null vstooltip={{options.templates.add.btnTooltip}} tabindex=0></span></th></tr><tr ng-if=\"options.filter.column!==undefined&&options.filter.column&&filterFocus\"><th class=\"headerCol headerColFilter\" ng-repeat=\"h in options.columns\" ng-show=\"h.visible===undefined||h.visible\" col-filter-template=h></th><th class=\"headerCol headerColAction\"></th></tr></thead><tbody class=tableBody><tr class=bodyRow ng-repeat=\"obj in !extDataPagination?filteredItems.slice(paginator.visiblePageIdx*pageSize.rows, paginator.visiblePageIdx*pageSize.rows+pageSize.rows):filteredItems track by $index\" ng-class-odd=\"'oddRow'\" ng-class-even=\"'evenRow'\" ng-click=\"rowClicked($event, obj)\" ng-keydown=\"rowClicked($event, obj)\" ng-class=\"{'selectedRow':isRowSelected(obj)}\" table-body-row tabindex=0><td class=\"bodyCol textOverflow\" ng-repeat=\"col in options.columns track by $index\" ng-if=\"options.columns[$index].visible===undefined||options.columns[$index].visible\" ng-style=\"{'text-align':col.textAlign}\" ng-class=getColumnStyle(obj,col) overlay-window={{getPropertyValue(obj,col.prop)}}>{{getPropertyValue(obj,col.prop)}}</td><td class=\"bodyCol bodyColAction\" ng-if=options.useTemplates><span class=\"icon icon-edit actionIcon\" ng-if=options.templates.edit.actionBtnShow ng-click=\"editRow($event, obj);$event.stopPropagation()\" ng-keydown=\"editRow($event, obj);$event.stopPropagation()\" vstooltip={{options.templates.edit.btnTooltip}} tabindex=0></span> <span class=\"icon icon-clear actionIcon\" ng-if=options.templates.delete.actionBtnShow ng-click=\"deleteRow($event, obj);$event.stopPropagation()\" ng-keydown=\"deleteRow($event, obj);$event.stopPropagation()\" vstooltip={{options.templates.delete.btnTooltip}} tabindex=0></span> <span class=\"icon icon-view actionIcon\" ng-if=options.templates.view.actionBtnShow ng-click=\"viewRow($event, obj);$event.stopPropagation()\" ng-keydown=\"viewRow($event, obj);$event.stopPropagation()\" vstooltip={{options.templates.view.btnTooltip}} tabindex=0></span></td></tr></tbody></table><div class=tableFooter table-paginator></div></div></div>");
  $templateCache.put("templates/vsdtbusyicon.html",
    "<div class=busyIconContainer ng-show=busyIcon><div class=busyIcon></div><div class=busyIconTxt>{{options.busyIcon.text}}</div></div>");
  $templateCache.put("templates/vsdtcaption.html",
    "<div class=caption><table style=width:100%><tr><td class=captionColToggler ng-show=options.columnToggler.visible ng-click=$event.stopPropagation()><div col-toggle-menu></div></td><td class=captionTitle><span ng-if=\"options.caption.text!==undefined\">{{options.caption.text}}</span></td><td class=captionFilter><div ng-show=\"options.filter.global!==undefined&&options.filter.global||options.filter.column!==undefined&&options.filter.column\"><span ng-show=filterFocus&&options.filter.global><input class=filterTxtBox placeholder={{options.filter.globalPlaceholder}} ng-model=globalFilter ng-model-options={debounce:options.filter.autoFilter.useAutoFilter?options.filter.autoFilter.filterDelay:config.FILTER_EXECUTION_DELAY} data-ng-trim=false filter-focus> <span class=\"icon icon-check actionIcon filterIcon\" ng-show=options.filter.global&&options.filter.filterBtn.visible vstooltip={{options.filter.filterBtn.filterBtnTooltip}} ng-click=execFilterAndSort() ng-keydown=checkEvent($event)?execFilterAndSort():null tabindex=0></span></span> <span class=\"icon icon-search actionIcon searchIcon\" vstooltip={{!filterFocus?options.filter.showFilterBtnTooltip:options.filter.hideFilterBtnTooltip}} ng-click=filterBtnClick($event) ng-keydown=filterBtnClick($event) tabindex=0></span></div></td></tr></table></div>");
  $templateCache.put("templates/vsdtcolresizer.html",
    "<div class=colresizer ng-click=$event.stopPropagation() style=\"position:absolute;border:1px solid transparent;background-color:transparent;top:0;bottom:0;right:0;width:6px;cursor:col-resize\"></div>");
  $templateCache.put("templates/vsdtcoltogglemenu.html",
    "<div><span class=\"icon icon-selections actionIcon\" ng-click=colTogglerShowClicked($event) ng-keydown=colTogglerShowClicked($event) tabindex=0 vstooltip={{options.columnToggler.btnTooltip}}></span><div class=colTogglerMenu ng-show=colTogglerShow><div class=colTogglerTitle ng-show=\"options.columnToggler.menuTitle !== undefined\"><span class=colTogglerTitleTxt>{{options.columnToggler.menuTitle}}</span> <span class=\"icon icon-cross actionIcon colTogglerCloseIcon\" ng-click=colTogglerShowClicked($event) ng-keydown=colTogglerShowClicked($event) tabindex=0></span></div><div class=colTogglerMenuItem ng-repeat=\"h in options.columns\" ng-class=\"{'selectedColTogglerMenuItem':h.visible}\" ng-click=colToggleMenuClicked($event,h) ng-keydown=colToggleMenuClicked($event,h) ng-model=h.visible tabindex=0><div class=colTogglerMenuItemTxt>{{h.label}}</div><div class=colTogglerMenuItemIcon><span class=\"icon icon-check actionIcon\" ng-show=h.visible></span></div></div></div></div>");
  $templateCache.put("templates/vsdtoverlaywindow.html",
    "<div class=overlay ng-click=closeOverlay($event)></div>");
  $templateCache.put("templates/vsdtpaginator.html",
    "<table style=\"width: 100%\"><tr class=paginator ng-if=options.paginator.visible><td><div style=float:left><span class=paginatorTxt>{{options.paginator.totalItemsTxt}}</span> <span class=paginatorTotalNbr>{{totalCount}}</span> <span class=paginatorPagesNbr ng-if=options.paginator.visible>({{paginator.visiblePageIdx+1}}/{{totalPages===0?1:totalPages}})</span></div></td><td><button class=paginatorBtn ng-style=\"{'margin-left':$index>0?'-1px':'0'}\" ng-class=\"{'selectedPaginatorBtn':b.id===paginator.visiblePageIdx+1, 'disabledPaginatorBtn':isDisabledBtn(b), 'paginatorBtnNbr': !isNavigateBtn(b), 'paginatorBtnSet': b===btnPrevSet||b===btnNextSet, 'paginatorBtnAll': b===btnFirst||b===btnLast}\" ng-click=paginatorBtnClick(b,$index) ng-repeat=\"b in paginatorButtons track by $index\">{{b.label}}</button></td><td><div style=float:right><span class=paginatorTxt>{{options.paginator.pageSizeTxt}}</span> <button class=\"paginatorBtn paginatorBtnPageSize\" ng-style=\"{'margin-left':$index>0?'-1px':'0'}\" ng-class=\"{'selectedPaginatorBtn':o.rows===pageSize.rows}\" ng-click=pageSizeButtonClick(o) ng-repeat=\"o in pageSizeOptions track by $index\">{{o.label}}</button></div></td></tr></table>");
  $templateCache.put("templates/vsdtrowextender.html",
    "<td class=bodyCol colspan={{visibleColCount+1}}><div ng-include src=template.path></div></td>");
  $templateCache.put("templates/vsdttooltip.html",
    "<div class=tooltip></div>");
}]);

angular.module("vsdatatable",["template-vsdatatable-0.1.5.html"]).constant("vsdtConf",{OVERLAY_SHOW_DELAY:500,TOOLTIP_SHOW_DELAY:500,TOOLTIP_CLOSE_DELAY:1200,FILTER_EXECUTION_DELAY:500,PAGINATOR_MAX_BTN_COUNT:6,PAGINATOR_EVENT:"vsdatatable.paginatorEvent",FILTER_FOCUS_EVENT:"vsdatatable.filterFocusEvent",SET_EXT_PAGINATION_DATA_EVENT:"vsdatatable.setExtPaginationData",OPER_PHASE_BEGIN:"BEGIN",OPER_PHASE_END:"END",OPER_ADD:"ADD",OPER_EDIT:"EDIT",OPER_DELETE:"DELETE",OPER_VIEW:"VIEW",EXT_INIT:"i",EXT_SORT:"s",EXT_FLT:"f",EXT_BTN:"b",ROW_SELECT:"SELECT",ROW_DESELECT:"DESELECT",COL_RESIZER_MIN_COL_WIDTH:35,DEFAULT_ACTION_COL_WIDTH:90,COLUMN_PROP_VALUE:"COLUMN_PROP_VALUE",DOT_SEPARATOR:".",YEAR:"yyyy",MONTH:"mm",DAY:"dd",DATES_SEPARATOR:" - "}).factory("vsdtEvent",["vsdtConf",function(a){var b={};return b.setExtPaginationData=function(b,c,d){b.$broadcast(a.SET_EXT_PAGINATION_DATA_EVENT,{data:c,totalCount:d})},b}]).service("vsdtServ",["$templateCache","vsdtConf",function(a,b){var c={};return c.isUndefined=function(a){return angular.isUndefined(a)},c.isEqual=function(a,b){return angular.equals(a,b)},c.isObject=function(a){return angular.isObject(a)},c.setFilterFocus=function(a){a.$broadcast(b.FILTER_FOCUS_EVENT)},c.paginatorEvent=function(a){a.$broadcast(b.PAGINATOR_EVENT)},c.getTemplate=function(b){return angular.element(a.get(b))},c}]).directive("vsdatatable",["$compile","$templateCache","vsdtConf","vsdtServ",function(a,b,c,d){return{restrict:"EA",templateUrl:"templates/vsdatatable.html",scope:{options:"="},controller:["$scope",function(a){a.config=c,a.colInitDone=!1,a.colTogglerShow=!1,a.busyIcon=!1,a.filteredItems=[],a.selectedRows=[],a.totalCount=0,a.sort={col:"",reverse:!1},a.globalFilter="",a.columnFilter={contain:{},exact:{},daterange:{}}}],link:function(b,c,e){function f(a){if(d.isEqual(b.options.row.selection,1)||d.isEqual(b.options.row.selection,2)){var c=b.selectedRows.indexOf(a);d.isEqual(c,-1)||(b.selectedRows.splice(c,1),b.notifyRowSelect(b.config.ROW_DESELECT,a))}}function g(a){b.sort={col:"",reverse:!1},b.resetFilter(a)}function h(){b.filteredItems=b.options.data.items,b.totalCount=b.filteredItems.length,g(!1),d.paginatorEvent(b)}function i(a){return angular.element(a.target).parent().parent()}function j(c){k(),o=d.getTemplate("templates/vsdtrowextender.html"),d.isEqual(p.oper,b.config.OPER_ADD)?c.prepend(o):c.after(o),a(o)(b)}function k(){d.isEqual(o,null)||(o.remove(),o=null)}function l(a){d.isUndefined(b.options.data.dataOperationCb)||b.options.data.dataOperationCb(a,p.oper,p.dataOld,d.isEqual(a,b.config.OPER_PHASE_BEGIN)?{}:p.dataNew)}function m(){b.extDataPagination=b.options.data.extDataPagination,b.extDataPagination||(q=b.$watch("options.data.items.length",h));var a=90/b.options.columns.length;b.visibleColCount=0,angular.forEach(b.options.columns,function(c){b.visibleColCount=d.isUndefined(c.visible)||c.visible?b.visibleColCount+1:b.visibleColCount,d.isUndefined(c.width)&&(c.width={number:a,unit:"%"})})}var n=null,o=null,p={},q=null;b.addRow=function(){p={oper:b.config.OPER_ADD,dataOld:{},dataNew:d.isUndefined(b.options.templates.add.defaultValues)?{}:angular.copy(b.options.templates.add.defaultValues)},l(b.config.OPER_PHASE_BEGIN),b.template=b.options.templates.add;var a=angular.element(c[0].querySelector(".tableRows .tableBody"));j(a)},b.editRow=function(a,c){b.checkEvent(a)&&(p={oper:b.config.OPER_EDIT,dataOld:c,dataNew:angular.copy(c)},l(b.config.OPER_PHASE_BEGIN),b.template=b.options.templates.edit,j(i(a)))},b.deleteRow=function(a,c){b.checkEvent(a)&&(p={oper:b.config.OPER_DELETE,dataOld:c,dataNew:{}},l(b.config.OPER_PHASE_BEGIN),b.template=b.options.templates["delete"],j(i(a)))},b.viewRow=function(a,c){b.checkEvent(a)&&(p={oper:b.config.OPER_VIEW,dataOld:c,dataNew:{}},l(b.config.OPER_PHASE_BEGIN),b.template=b.options.templates.view,j(i(a)))},b.acceptClicked=function(){k(),l(b.config.OPER_PHASE_END),!b.extDataPagination&&d.isEqual(p.oper,b.config.OPER_EDIT)?b.execFilter():b.extDataPagination&&!d.isEqual(p.oper,b.config.OPER_VIEW)&&b.paginationOperation(p.oper),f(p.dataOld)},b.cancelClicked=function(){k()},b.notifyRowSelect=function(a,c){d.isUndefined(b.options.row.rowSelectCb)||b.options.row.rowSelectCb(a,c)},b.$on(b.config.SET_EXT_PAGINATION_DATA_EVENT,function(a,c){b.filteredItems=c.data,b.totalCount=c.totalCount,d.isEqual(n,b.config.EXT_BTN)||d.isEqual(n,b.config.OPER_EDIT)||d.isEqual(n,b.config.EXT_SORT)||d.paginatorEvent(b),b.options.busyIcon.visible&&(b.busyIcon=!1)}),b.getColumns=function(){return b.options.columns},b.getOperationDataObject=function(){return d.isEqual(p.oper,b.config.OPER_ADD)||d.isEqual(p.oper,b.config.OPER_EDIT)?{oper:p.oper,data:p.dataNew}:{oper:p.oper,data:p.dataOld}},b.getPropertyValue=function(a,c){if(d.isEqual(c.indexOf(b.config.DOT_SEPARATOR),-1))return a[c];var e=c.split(b.config.DOT_SEPARATOR),f=angular.copy(a);return angular.forEach(e,function(a){f=f[a]}),f},b.getColumnStyle=function(a,c){if(!d.isUndefined(c.rules)){var e="";for(var f in c.rules){var g=b.getPropertyValue(a,c.rules[f].prop),h=angular.copy(c.rules[f].expression.toString());if(h=h.split(c.rules[f].prop).join(g.toString()),b.$eval(h)){e=c.rules[f].style;break}}return e}},b.paginationOperation=function(a){b.extDataPagination&&(b.options.busyIcon.visible&&(b.busyIcon=!0),n=a,(d.isEqual(a,b.config.OPER_ADD)||d.isEqual(a,b.config.OPER_DELETE)||d.isEqual(a,b.config.EXT_FLT))&&(b.paginator.visiblePageIdx=0),(d.isEqual(a,b.config.OPER_ADD)||d.isEqual(a,b.config.OPER_DELETE))&&g(!1),b.options.data.extPaginationOperationCb({columnFilter:b.columnFilter,globalFilter:b.globalFilter,page:b.paginator.visiblePageIdx+1,pageSize:b.pageSize.rows,sort:b.sort}))},b.checkEvent=function(a){return(d.isEqual(a.which,1)||d.isEqual(a.which,13))&&!b.busyIcon};var r=c.on("click",function(a){1===a.which&&b.colTogglerShow&&(b.colTogglerShow=!1,b.$apply())});b.$on("$destroy",function(){d.isEqual(q,null)||q(),b.$off(b.config.SET_EXT_PAGINATION_DATA_EVENT),c.off("click",r)}),m()}}}]).directive("filterFocus",["$timeout",function(a){return{restrict:"A",scope:!1,link:function(b,c,d){b.$on(b.config.FILTER_FOCUS_EVENT,function(){a(function(){c[0].focus()})}),b.$on("$destroy",function(){b.$off(b.config.FILTER_FOCUS_EVENT)})}}}]).directive("colFilterTemplate",["$compile","vsdtServ",function(a,b){return{restrict:"A",scope:!1,link:function(c,d,e){function f(){var f=c.$eval(e.colFilterTemplate);if(!b.isUndefined(f.filter)&&!b.isUndefined(f.filter.template)&&!b.isUndefined(f.filter.match)){var g=angular.copy(f.filter.template);g=g.replace(c.config.COLUMN_PROP_VALUE,"columnFilter"+c.config.DOT_SEPARATOR+f.filter.match+c.config.DOT_SEPARATOR+f.prop+'"');var h=angular.element(g);a(h)(c),d.append(h)}}f()}}}]).directive("tableBodyRow",["vsdtServ",function(a){return{restrict:"A",scope:!1,link:function(b,c,d){function e(c){return(a.isEqual(c.which,1)||a.isEqual(c.which,13))&&(1===b.options.row.selection||2===b.options.row.selection)}function f(){c.addClass("hoverRow")}function g(){c.removeClass("hoverRow")}function h(){b.options.row.hover&&(c.on("mouseenter",f),c.on("mouseleave",g))}b.rowClicked=function(c,d){if(e(c)){var f=b.config.ROW_SELECT,g=b.selectedRows.indexOf(d);1===b.options.row.selection&&a.isEqual(g,-1)?(b.selectedRows.length>0&&b.notifyRowSelect(b.config.ROW_DESELECT,b.selectedRows[0]),b.selectedRows[0]=d):1!==b.options.row.selection||a.isEqual(g,-1)?2===b.options.row.selection&&a.isEqual(g,-1)?b.selectedRows.push(d):2!==b.options.row.selection||a.isEqual(g,-1)||(b.selectedRows.splice(g,1),f=b.config.ROW_DESELECT):(b.selectedRows.splice(0,1),f=b.config.ROW_DESELECT),b.notifyRowSelect(f,d)}},b.isRowSelected=function(c){return!a.isEqual(b.selectedRows.indexOf(c),-1)},b.$on("$destroy",function(){b.options.row.hover&&(c.off("mouseenter",f),c.off("mouseleave",g))}),h()}}}]).directive("tablePaginator",["vsdtServ",function(a){return{restrict:"A",scope:!1,templateUrl:"templates/vsdtpaginator.html",link:function(b,c,d){function e(c){a.isEqual(c,b.btnFirst)?g(0,c):a.isEqual(c,b.btnPrev)?a.isEqual(b.paginator.visiblePageIdx-b.paginator.pageFirstIdx,0)?g(b.paginator.visiblePageIdx-p,c):h(b.paginator.visiblePageIdx-1,b.paginator.pageFirstIdx):a.isEqual(c,b.btnPrevSet)?g(b.paginator.pageFirstIdx-p,c):a.isEqual(c,b.btnLast)?g(b.totalPages-1,c):a.isEqual(c,b.btnNext)?a.isEqual(b.paginator.visiblePageIdx-b.paginator.pageFirstIdx,p-1)?g(b.paginator.pageFirstIdx+p,c):h(b.paginator.visiblePageIdx+1,b.paginator.pageFirstIdx):a.isEqual(c,b.btnNextSet)&&g(b.paginator.pageFirstIdx+p,c)}function f(a){b.totalPages=Math.ceil(a/b.pageSize.rows)}function g(c,d){var e=0,f=0;if(c>b.paginator.visiblePageIdx)if(e=c,a.isEqual(d,b.btnLast))f=e-p+1;else{var g=i(c);f=a.isEqual(g,c)?c:g}else if(c<b.paginator.visiblePageIdx&&!a.isEqual(d,b.btnFirst)){var g=j(c);e=c+p-1,f=a.isEqual(g,c)?c:g}h(e,f)}function h(a,c){b.paginator={visiblePageIdx:a,pageFirstIdx:c},k()}function i(a){return a+p>b.totalPages?b.totalPages-p:a}function j(a){return 0>a?0:a}function k(){p=b.totalPages>o?o:b.totalPages;var a=b.paginator.visiblePageIdx!==b.paginator.pageFirstIdx?b.paginator.pageFirstIdx:b.paginator.visiblePageIdx;b.paginatorButtons.length=0,b.options.paginator.firstLastBtn.visible&&b.paginatorButtons.push(b.btnFirst),b.options.paginator.prevNextBtn.visible&&b.paginatorButtons.push(b.btnPrev),b.options.paginator.prevNextSetBtn.visible&&b.paginatorButtons.push(b.btnPrevSet);for(var c=a;p+a>c;c++)b.paginatorButtons.push({id:c+1,label:c+1});b.options.paginator.prevNextSetBtn.visible&&b.paginatorButtons.push(b.btnNextSet),b.options.paginator.prevNextBtn.visible&&b.paginatorButtons.push(b.btnNext),b.options.paginator.firstLastBtn.visible&&b.paginatorButtons.push(b.btnLast),l()}function l(){b.disabledButtons.length=0,a.isEqual(b.paginator.visiblePageIdx,0)&&(b.disabledButtons.push(b.btnFirst),b.disabledButtons.push(b.btnPrev)),a.isEqual(b.paginator.pageFirstIdx,0)&&b.disabledButtons.push(b.btnPrevSet),b.paginator.pageFirstIdx+p>=b.totalPages&&b.disabledButtons.push(b.btnNextSet),b.paginator.visiblePageIdx>=b.totalPages-1&&(b.disabledButtons.push(b.btnLast),b.disabledButtons.push(b.btnNext))}function m(){f(b.totalCount),h(0,0)}function n(){b.btnPrev={id:"b",label:b.options.paginator.prevNextBtn.labels[0]},b.btnNext={id:"n",label:b.options.paginator.prevNextBtn.labels[1]},b.btnFirst={id:"f",label:b.options.paginator.firstLastBtn.labels[0]},b.btnLast={id:"l",label:b.options.paginator.firstLastBtn.labels[1]},b.btnPrevSet={id:"ps",label:b.options.paginator.prevNextSetBtn.labels[0]},b.btnNextSet={id:"ns",label:b.options.paginator.prevNextSetBtn.labels[1]},b.pageSizeOptions=b.options.paginator.pageSizeOptions,o=b.options.paginator.numberBtnCount>b.config.PAGINATOR_MAX_BTN_COUNT?b.config.PAGINATOR_MAX_BTN_COUNT:b.options.paginator.numberBtnCount;var a=0;for(var c in b.pageSizeOptions)if(b.pageSizeOptions[c].hasOwnProperty("default")&&angular.equals(b.pageSizeOptions[c]["default"],!0)){a=c;break}b.pageSize=b.pageSizeOptions[a],m()}b.paginator={visiblePageIdx:0,pageFirstIdx:0},b.paginatorButtons=[],b.disabledButtons=[];var o=0,p=0;b.pageSizeButtonClick=function(a){b.pageSize=b.pageSizeOptions[b.pageSizeOptions.indexOf(a)],m(),b.extDataPagination&&b.paginationOperation(b.config.EXT_BTN)},b.paginatorBtnClick=function(a,c){b.isDisabledBtn(a)||(b.isNavigateBtn(a)?e(a):h(a.id-1,b.paginator.pageFirstIdx,c-2),b.extDataPagination&&b.paginationOperation(b.config.EXT_BTN))},b.isNavigateBtn=function(c){return a.isEqual(c,b.btnFirst)||a.isEqual(c,b.btnPrev)||a.isEqual(c,b.btnPrevSet)||a.isEqual(c,b.btnNext)||a.isEqual(c,b.btnNextSet)||a.isEqual(c,b.btnLast)},b.isDisabledBtn=function(c){return b.isNavigateBtn(c)&&!a.isEqual(b.disabledButtons.indexOf(c),-1)},b.$on(b.config.PAGINATOR_EVENT,function(){m()}),b.$on("$destroy",function(){b.$off(b.config.PAGINATOR_EVENT)}),n()}}}]).directive("colToggleMenu",function(){return{restrict:"A",scope:!1,templateUrl:"templates/vsdtcoltogglemenu.html",link:function(a,b,c){a.colTogglerShowClicked=function(b){a.checkEvent(b)&&(a.colTogglerShow=!a.colTogglerShow)},a.colToggleMenuClicked=function(b,c){a.checkEvent(b)&&(a.visibleColCount=c.visible?a.visibleColCount-1:a.visibleColCount+1,c.visible=!c.visible,a.colInitDone=!0)}}}}).directive("captionBar",["$filter","vsdtServ",function(a,b){return{restrict:"A",scope:!1,templateUrl:"templates/vsdtcaption.html",link:function(c,d,e){function f(a){for(var d in c.options.columns)if(b.isEqual(c.options.columns[d].prop,a))return c.options.columns[d].filter.dateFormat}function g(a,b){b=b.toLowerCase();var d=b.indexOf(c.config.YEAR),e=b.indexOf(c.config.MONTH),f=b.indexOf(c.config.DAY);return new Date(parseInt(a.substring(d,d+4)),parseInt(a.substring(e,e+2))-1,parseInt(a.substring(f,f+2)))}function h(a){var c={};return angular.forEach(a,function(a,d){b.isEqual(a,"")||(c[d]=a)}),c}function i(){b.isEqual(c.sort.col,"")||(c.filteredItems=q(c.filteredItems,c.sort.col,c.sort.reverse))}function j(a,d){b.isObject(a)&&b.isEqual(d.contain,{})&&b.isEqual(d.exact,{})||(!b.isEqual(a,d)&&t&&c.execFilterAndSort(),t=!0)}function k(a,d){!b.isEqual(a,d)&&a&&b.setFilterFocus(c)}function l(){var a="";return angular.forEach(c.options.columns,function(d){b.isUndefined(d.filter)||b.isUndefined(d.filter.template)||(a+="columnFilter."+d.filter.match+c.config.DOT_SEPARATOR+d.prop+" + ")}),a}function m(a){angular.forEach(a,function(b,c){a[c]=""})}function n(){if(c.options.filter.global||c.options.filter.column){var a=l();c.options.filter.autoFilter.useAutoFilter&&(a+="globalFilter",o=c.$watch(a,j))}c.options.filter.global&&(p=c.$watch("filterFocus",k))}c.filterFocus=!1;var o=null,p=null,q=a("orderBy"),r=a("filter"),s=a("dateRangeFilter"),t=!0;c.filterBtnClick=function(a){c.checkEvent(a)&&(c.filterFocus=!c.filterFocus,c.filterFocus||c.resetFilter(!0))},c.execFilterAndSort=function(){c.extDataPagination?c.paginationOperation(c.config.EXT_FLT):(c.execFilter(),i(),b.paginatorEvent(c))},c.resetFilter=function(a){t=a,c.globalFilter="",m(c.columnFilter.contain),m(c.columnFilter.exact),m(c.columnFilter.daterange),!c.options.filter.autoFilter.useAutoFilter&&a&&c.execFilterAndSort()},c.sortByCol=function(a,d){a.stopPropagation(),c.checkEvent(a)&&(b.isEqual(c.sort.col,d)?c.sort.reverse=!c.sort.reverse:c.sort.reverse=!1,c.sort.col=d,c.extDataPagination||(b.isEqual(d,"")&&c.execFilter(),i()),c.paginationOperation(c.config.EXT_SORT))},c.execFilter=function(){c.filteredItems=c.options.data.items,b.isEqual(c.globalFilter,"")||(c.filteredItems=r(c.filteredItems,c.globalFilter));var a=h(c.columnFilter.contain);b.isEqual(a,{})||(c.filteredItems=r(c.filteredItems,a));var d=h(c.columnFilter.exact);b.isEqual(d,{})||(c.filteredItems=r(c.filteredItems,d,function(a,c){return b.isEqual(a.toString(),c)||b.isEqual(c,"")}));var e=h(c.columnFilter.daterange);b.isEqual(e,{})||angular.forEach(e,function(a,d){var e=a.split(c.config.DATES_SEPARATOR);if(b.isEqual(e.length,2)&&b.isEqual(e[0].length,10)&&b.isEqual(e[1].length,10)){var h=f(d);c.filteredItems=s(c.filteredItems,d,g(e[0],h),g(e[1],h))}}),c.totalCount=c.filteredItems.length},c.$on("$destroy",function(){b.isEqual(o,null)||o(),b.isEqual(p,null)||p()}),n()}}}]).filter("dateRangeFilter",function(){return function(a,b,c,d){var e=[];return angular.forEach(a,function(a){var f=new Date(a[b]);f>=c&&d>=f&&e.push(a)}),e}}).directive("overlayWindow",["$compile","$timeout","vsdtServ",function(a,b,c){return{restrict:"A",scope:!1,link:function(d,e,f){function g(){e[0].scrollWidth>e[0].offsetWidth&&(l=b(function(){k=c.getTemplate("templates/vsdtoverlaywindow.html"),k.css("margin-top","-20px"),k.css("margin-left","14px"),k.text(f.overlayWindow),e.append(a(k)(d))},d.config.OVERLAY_SHOW_DELAY))}function h(){i(),angular.equals(k,null)||(k.remove(),k=null)}function i(){b.cancel(l),l=null}function j(){d.options.showOverlay&&(e.on("mouseenter",g),e.on("mouseleave",h))}var k=null,l=null;d.closeOverlay=function(a){a.stopPropagation(),h()},d.$on("$destroy",function(){e.off("mouseenter",g),e.off("mouseleave",h)}),j()}}}]).directive("vstooltip",["$compile","$timeout","vsdtServ",function(a,b,c){return{restrict:"A",scope:!1,link:function(d,e,f){function g(){n=b(function(){i(),o=b(function(){j()},d.config.TOOLTIP_CLOSE_DELAY,!0)},d.config.TOOLTIP_SHOW_DELAY,!0)}function h(){k(),j()}function i(){m=c.getTemplate("templates/vsdttooltip.html"),m.css("margin-left",e.prop("offsetLeft")+"px"),m.text(f.vstooltip),e.append(a(m)(d))}function j(){angular.equals(m,null)||(m.remove(),m=null)}function k(){b.cancel(n),b.cancel(o)}function l(){d.options.showTooltips&&(e.on("mouseenter",g),e.on("mouseleave",h))}var m=null,n=null,o=null;d.$on("$destroy",function(){e.off("mouseenter",g),e.off("mouseleave",h)}),l()}}}]).directive("colResizer",["$compile","$document","vsdtServ",function(a,b,c){return{restrict:"A",scope:!1,link:function(d,e,f){function g(a){a.preventDefault(),n=a.clientX,o=e.next(),c.isEqual(o.prop("id"),"headerColAction")||(p=e.prop("offsetWidth"),q=o.prop("offsetWidth"),r=e.parent().prop("offsetWidth"),b.on("mousemove",h),b.on("mouseup",i),j("col-resize"))}function h(a){var b=a.clientX-n,c=p+b,f=q-b;b>0&&f<d.config.COL_RESIZER_MIN_COL_WIDTH||0>b&&c<d.config.COL_RESIZER_MIN_COL_WIDTH||(e.css("width",c/r*100+"%"),o.css("width",f/r*100+"%"))}function i(){b.off("mousemove",h),b.off("mouseup",i),j("default")}function j(a){b.prop("body").style.cursor=a}function k(){var a=100-d.config.DEFAULT_ACTION_COL_WIDTH/e.parent().prop("offsetWidth")*100;return a/d.visibleColCount}function l(){var a=k();angular.forEach(d.options.columns,function(b){b.visible&&(b.width={number:a,unit:"%"})})}function m(){d.options.columnResize&&(s=c.getTemplate("templates/vsdtcolresizer.html"),s.on("mousedown",g),e.css("background-clip","padding-box"),e.css("position","relative"),e.append(a(s)(d))),d.colInitDone&&l()}var n=0,o=0,p=0,q=0,r=0,s=null;d.$on("$destroy",function(){s.off("mousedown",g),l()}),m()}}}]);