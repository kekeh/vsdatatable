/* 
*  Name: vsdatatable 
*  Description: Simple single page datatable - AngularJS reusable UI component 
*  Version: 0.1.3 
*  Author: kekeh 
*  Homepage: http://kekeh.github.io/vsdatatable 
*  License: MIT 
*  Date: 2015-08-06 
*/ 
angular.module('template-vsdatatable-0.1.3.html', ['templates/vscaption.html', 'templates/vscoltogglemenu.html', 'templates/vsdatatable.html', 'templates/vspaginator.html']);

angular.module("templates/vscaption.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("templates/vscaption.html",
    "<div class=\"caption\">\n" +
    "    <table style=\"width:100%\">\n" +
    "        <tr>\n" +
    "            <td class=\"captionColToggler\" ng-show=\"options.columnToggler.visible\" ng-click=\"$event.stopPropagation()\">\n" +
    "                <div col-toggle-menu></div>\n" +
    "            </td>\n" +
    "            <td class=\"captionTitle\"><span ng-if=\"options.caption.text!==undefined\">{{options.caption.text}}</span></td>\n" +
    "            <td class=\"captionFilter\">\n" +
    "                <div ng-show=\"options.filter.global!==undefined&&options.filter.global||options.filter.column!==undefined&&options.filter.column\">\n" +
    "                    <span ng-show=\"filterFocus&&options.filter.global\">\n" +
    "                        <input class=\"filterTxtBox\" placeholder=\"{{options.filter.globalPlaceholder}}\" type=\"text\" ng-model=\"globalFilter\" ng-model-options=\"{debounce:options.filter.autoFilter.useAutoFilter?options.filter.autoFilter.filterDelay:config.FILTER_EXECUTION_DELAY}\" data-ng-trim=\"false\" filter-focus/>\n" +
    "                        <span class=\"icon icon-check actionIcon filterIcon\" ng-show=\"options.filter.global&&options.filter.filterBtn.visible\" vstooltip=\"{{options.filter.filterBtn.filterBtnTooltip}}\" ng-click=\"execFilterAndSort()\" ng-keydown=\"checkEvent($event)?execFilterAndSort():null\" tabindex=\"0\"></span>\n" +
    "                    </span>\n" +
    "                    <span class=\"icon icon-search actionIcon searchIcon\" vstooltip=\"{{!filterFocus?options.filter.showFilterBtnTooltip:options.filter.hideFilterBtnTooltip}}\" ng-click=\"filterBtnClick($event)\" ng-keydown=\"filterBtnClick($event)\" tabindex=\"0\"></span>\n" +
    "                </div>\n" +
    "            </td>\n" +
    "        </tr>\n" +
    "    </table>\n" +
    "</div>");
}]);

angular.module("templates/vscoltogglemenu.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("templates/vscoltogglemenu.html",
    "<div>\n" +
    "    <span class=\"icon icon-selections actionIcon\" ng-click=\"colTogglerShowClicked($event)\" ng-keydown=\"colTogglerShowClicked($event)\" tabindex=\"0\" vstooltip=\"{{options.columnToggler.btnTooltip}}\"></span>\n" +
    "    <div class=\"colTogglerMenu\" ng-show=\"colTogglerShow\">\n" +
    "        <div class=\"colTogglerTitle\" ng-show=\"options.columnToggler.menuTitle !== undefined\">\n" +
    "            <span class=\"colTogglerTitleTxt\">{{options.columnToggler.menuTitle}}</span>\n" +
    "            <span class=\"icon icon-cross actionIcon colTogglerCloseIcon\" ng-click=\"colTogglerShowClicked($event)\" ng-keydown=\"colTogglerShowClicked($event)\" tabindex=\"0\"></span>\n" +
    "        </div>\n" +
    "        <div class=\"colTogglerMenuItem\" ng-repeat=\"h in options.columns\" ng-class=\"{'selectedColTogglerMenuItem':h.visible}\" ng-click=\"colToggleMenuClicked($event,h)\" ng-keydown=\"colToggleMenuClicked($event,h)\" ng-model=\"h.visible\" tabindex=\"0\">\n" +
    "            <div class=\"colTogglerMenuItemTxt\">{{h.label}}</div>\n" +
    "            <div class=\"colTogglerMenuItemIcon\">\n" +
    "                <span class=\"icon icon-check actionIcon\" ng-show=\"h.visible\"></span>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</div>");
}]);

angular.module("templates/vsdatatable.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("templates/vsdatatable.html",
    "<div class=\"vsdatatable\" ng-style=\"{'pointer-events':busyIcon?'none':'auto'}\">\n" +
    "    <div ng-if=\"options.busyIcon.visible\" ng-include=\"'datatablebusyicon.html'\"></div>\n" +
    "    <div ng-style=\"{'opacity':busyIcon?'0.4':'1'}\">\n" +
    "        <div caption-bar></div>\n" +
    "        <table class=\"tableRows\">\n" +
    "            <thead class=\"tableHeader\" ng-if=\"options.headerVisible\">\n" +
    "            <tr class=\"headerRow\">\n" +
    "                <th style=\"position:static\" class=\"headerCol textOverflow\" col-resizer ng-if=\"h.visible===undefined||h.visible\" ng-style=\"{'width':h.width.number+h.width.unit, 'cursor':h.sorting?'pointer':'default'}\" ng-class=\"sort.col===h.prop&&h.sorting?'selectedHeaderCol':''\" ng-repeat=\"h in options.columns\" ng-click=\"h.sorting?sortByCol($event,h.prop):null\" ng-keydown=\"h.sorting?sortByCol($event,h.prop):null\">\n" +
    "                    {{h.label}}\n" +
    "                    <span class=\"icon sortColIcon\" ng-if=\"h.sorting\" ng-class=\"{'selectedHeaderCol':sort.col===h.prop&&h.sorting, 'icon-sort':h.sorting&&sort.col!==h.prop, 'icon-down':sort.col===h.prop&&sort.reverse, 'icon-up':sort.col===h.prop&&!sort.reverse}\" tabindex=\"0\"></span>\n" +
    "                    <span class=\"icon icon-cross sortColIcon\" ng-if=\"h.sorting&&sort.col===h.prop\" ng-click=\"sortByCol($event,'')\" ng-keydown=\"sortByCol($event,'')\" tabindex=\"0\"></span>\n" +
    "                </th>\n" +
    "                <th id=\"headerColAction\" class=\"headerCol headerColAction\" ng-if=\"options.useTemplates\" ng-style=\"{'width': config.DEFAULT_ACTION_COL_WIDTH + 'px'}\">\n" +
    "                    <span>{{options.actionColumnText}}</span>\n" +
    "                    <span class=\"icon icon-plus actionIcon addItemIcon\" ng-if=\"options.templates.add.actionBtnShow\" ng-click=\"addRow();\" ng-keydown=\"checkEvent($event)?addRow():null\" vstooltip=\"{{options.templates.add.btnTooltip}}\" tabindex=\"0\"></span>\n" +
    "                </th>\n" +
    "            </tr>\n" +
    "            <tr ng-if=\"options.filter.column!==undefined&&options.filter.column&&filterFocus\">\n" +
    "                <th class=\"headerCol headerColFilter\" ng-repeat=\"h in options.columns\" ng-show=\"h.visible===undefined||h.visible\" col-filter-template=\"h\"></th>\n" +
    "                <th class=\"headerCol headerColAction\"></th>\n" +
    "            </tr>\n" +
    "            </thead>\n" +
    "            <tbody class=\"tableBody\">\n" +
    "            <tr class=\"bodyRow\" ng-repeat=\"obj in !extDataPagination?filteredItems.slice(paginator.visiblePageIdx*pageSize.rows, paginator.visiblePageIdx*pageSize.rows+pageSize.rows):filteredItems track by $index\"\n" +
    "                ng-class-odd=\"'oddRow'\" ng-class-even=\"'evenRow'\" ng-click=\"rowClicked($event, obj)\" ng-keydown=\"rowClicked($event, obj)\" ng-class=\"{'selectedRow':isRowSelected(obj)}\" table-body-row tabindex=\"0\">\n" +
    "                <td class=\"bodyCol textOverflow\" ng-repeat=\"col in options.columns track by $index\" ng-if=\"options.columns[$index].visible===undefined||options.columns[$index].visible\" ng-style=\"{'text-align':col.textAlign}\" ng-class=\"getColumnStyle(obj,col)\" overlay-window=\"{{getPropertyValue(obj,col.prop)}}\">\n" +
    "                    {{getPropertyValue(obj,col.prop)}}\n" +
    "                </td>\n" +
    "                <td class=\"bodyCol bodyColAction\" ng-if=\"options.useTemplates\">\n" +
    "                    <span class=\"icon icon-edit actionIcon\" ng-if=\"options.templates.edit.actionBtnShow\" ng-click=\"editRow($event, obj);$event.stopPropagation()\" ng-keydown=\"editRow($event, obj);$event.stopPropagation()\" vstooltip=\"{{options.templates.edit.btnTooltip}}\" tabindex=\"0\"></span>\n" +
    "                    <span class=\"icon icon-clear actionIcon\" ng-if=\"options.templates.delete.actionBtnShow\" ng-click=\"deleteRow($event, obj);$event.stopPropagation()\" ng-keydown=\"deleteRow($event, obj);$event.stopPropagation()\" vstooltip=\"{{options.templates.delete.btnTooltip}}\" tabindex=\"0\"></span>\n" +
    "                    <span class=\"icon icon-view actionIcon\" ng-if=\"options.templates.view.actionBtnShow\" ng-click=\"viewRow($event, obj);$event.stopPropagation()\" ng-keydown=\"viewRow($event, obj);$event.stopPropagation()\" vstooltip=\"{{options.templates.view.btnTooltip}}\" tabindex=\"0\"></span>\n" +
    "                </td>\n" +
    "            </tr>\n" +
    "            </tbody>\n" +
    "        </table>\n" +
    "        <div class=\"tableFooter\" table-paginator></div>\n" +
    "    </div>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"datatableoverlaywindow.html\">\n" +
    "        <div class=\"overlay\" ng-click=\"closeOverlay($event)\"></div>\n" +
    "    </script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"datatabletooltip.html\">\n" +
    "        <div class=\"tooltip\"></div>\n" +
    "    </script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"datatablecolresizer.html\">\n" +
    "        <div class=\"colresizer\" ng-click=\"$event.stopPropagation()\"\n" +
    "             style=\"position:absolute;border:1px solid transparent;background-color:transparent;top:0;bottom:0;right:0;width:6px;cursor:col-resize\"></div>\n" +
    "    </script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"datatablebusyicon.html\">\n" +
    "        <div class=\"busyIconContainer\" ng-show=\"busyIcon\">\n" +
    "            <div class=\"busyIcon\"></div>\n" +
    "            <div class=\"busyIconTxt\">{{options.busyIcon.text}}</div>\n" +
    "        </div>\n" +
    "    </script>\n" +
    "</div>");
}]);

angular.module("templates/vspaginator.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("templates/vspaginator.html",
    "<table style=\"width: 100%\">\n" +
    "    <tr class=\"paginator\" ng-if=\"options.paginator.visible\">\n" +
    "        <td>\n" +
    "            <div style=\"float:left;\">\n" +
    "                <span class=\"paginatorTxt\">{{options.paginator.totalItemsTxt}}</span>\n" +
    "                <span class=\"paginatorTotalNbr\">{{totalCount}}</span>\n" +
    "                <span class=\"paginatorPagesNbr\" ng-if=\"options.paginator.visible\">({{paginator.visiblePageIdx+1}}/{{totalPages===0?1:totalPages}})</span>\n" +
    "            </div>\n" +
    "        </td>\n" +
    "        <td>\n" +
    "            <button class=\"paginatorBtn\" ng-style=\"{'margin-left':$index>0?'-1px':'0'}\" ng-class=\"{'selectedPaginatorBtn':b.id===paginator.visiblePageIdx+1, 'disabledPaginatorBtn':isDisabledBtn(b), 'paginatorBtnNbr': !isNavigateBtn(b), 'paginatorBtnSet': b===btnPrevSet||b===btnNextSet, 'paginatorBtnAll': b===btnFirst||b===btnLast}\" ng-click=\"paginatorBtnClick(b,$index)\" ng-repeat=\"b in paginatorButtons track by $index\">{{b.label}}</button>\n" +
    "        </td>\n" +
    "        <td>\n" +
    "            <div style=\"float:right;\">\n" +
    "                <span class=\"paginatorTxt\">{{options.paginator.pageSizeTxt}}</span>\n" +
    "                <button class=\"paginatorBtn paginatorBtnPageSize\" ng-style=\"{'margin-left':$index>0?'-1px':'0'}\" ng-class=\"{'selectedPaginatorBtn':o.rows===pageSize.rows}\" ng-click=\"pageSizeButtonClick(o)\" ng-repeat=\"o in pageSizeOptions track by $index\">{{o.label}}</button>\n" +
    "            </div>\n" +
    "        </td>\n" +
    "    </tr>\n" +
    "</table>");
}]);

angular.module("vsdatatable",["template-vsdatatable-0.1.3.html"]).constant("vsdtConf",{OVERLAY_SHOW_DELAY:500,TOOLTIP_SHOW_DELAY:500,TOOLTIP_CLOSE_DELAY:1200,FILTER_EXECUTION_DELAY:500,PAGINATOR_MAX_BTN_COUNT:6,PAGINATOR_EVENT:"vsdatatable.paginatorEvent",FILTER_FOCUS_EVENT:"vsdatatable.filterFocusEvent",SET_EXT_PAGINATION_DATA_EVENT:"vsdatatable.setExtPaginationData",OPER_PHASE_BEGIN:"BEGIN",OPER_PHASE_END:"END",OPER_ADD:"ADD",OPER_EDIT:"EDIT",OPER_DELETE:"DELETE",OPER_VIEW:"VIEW",EXT_INIT:"i",EXT_SORT:"s",EXT_FLT:"f",EXT_BTN:"b",ROW_SELECT:"SELECT",ROW_DESELECT:"DESELECT",COL_RESIZER_MIN_COL_WIDTH:35,DEFAULT_ACTION_COL_WIDTH:90,COLUMN_PROP_VALUE:"COLUMN_PROP_VALUE",DOT_SEPARATOR:".",YEAR:"yyyy",MONTH:"mm",DAY:"dd",DATES_SEPARATOR:" - "}).run(["$templateCache",function(a){a.put("rowExtender.html",'<td class="bodyCol" colspan="{{visibleColCount+1}}"><div ng-include src="template.path"></div></td>')}]).factory("vsdtEvent",["vsdtConf",function(a){var b={};return b.setExtPaginationData=function(b,c,d){b.$broadcast(a.SET_EXT_PAGINATION_DATA_EVENT,{data:c,totalCount:d})},b}]).service("vsdtServ",["$http","$templateCache","vsdtConf",function(a,b,c){var d={};return d.isUndefined=function(a){return angular.isUndefined(a)},d.isEqual=function(a,b){return angular.equals(a,b)},d.isObject=function(a){return angular.isObject(a)},d.setFilterFocus=function(a){a.$broadcast(c.FILTER_FOCUS_EVENT)},d.paginatorEvent=function(a){a.$broadcast(c.PAGINATOR_EVENT)},d.getTemplate=function(c){var d=a.get(c,{cache:b}).success(function(a){return a.data});return d},d}]).directive("vsdatatable",["$compile","$templateCache","vsdtConf","vsdtServ",function(a,b,c,d){return{restrict:"EA",templateUrl:"templates/vsdatatable.html",scope:{options:"="},controller:["$scope",function(a){a.config=c,a.colInitDone=!1,a.colTogglerShow=!1,a.busyIcon=!1,a.filteredItems=[],a.selectedRows=[],a.totalCount=0,a.sort={col:"",reverse:!1},a.globalFilter="",a.columnFilter={contain:{},exact:{},daterange:{}}}],link:function(c,e,f){function g(a){if(d.isEqual(c.options.row.selection,1)||d.isEqual(c.options.row.selection,2)){var b=c.selectedRows.indexOf(a);d.isEqual(b,-1)||(c.selectedRows.splice(b,1),c.notifyRowSelect(c.config.ROW_DESELECT,a))}}function h(a){c.sort={col:"",reverse:!1},c.resetFilter(a)}function i(){c.filteredItems=c.options.data.items,c.totalCount=c.filteredItems.length,h(!1),d.paginatorEvent(c)}function j(a){return angular.element(a.target).parent().parent()}function k(e){l(),p=angular.element(b.get("rowExtender.html")),d.isEqual(q.oper,c.config.OPER_ADD)?e.prepend(p):e.after(p),a(p)(c)}function l(){d.isEqual(p,null)||(p.remove(),p=null)}function m(a){d.isUndefined(c.options.data.dataOperationCb)||c.options.data.dataOperationCb(a,q.oper,q.dataOld,d.isEqual(a,c.config.OPER_PHASE_BEGIN)?{}:q.dataNew)}function n(){c.extDataPagination=c.options.data.extDataPagination,c.extDataPagination||(r=c.$watch("options.data.items.length",i));var a=90/c.options.columns.length;c.visibleColCount=0,angular.forEach(c.options.columns,function(b){c.visibleColCount=d.isUndefined(b.visible)||b.visible?c.visibleColCount+1:c.visibleColCount,d.isUndefined(b.width)&&(b.width={number:a,unit:"%"})})}var o=null,p=null,q={},r=null;c.addRow=function(){q={oper:c.config.OPER_ADD,dataOld:{},dataNew:d.isUndefined(c.options.templates.add.defaultValues)?{}:angular.copy(c.options.templates.add.defaultValues)},m(c.config.OPER_PHASE_BEGIN),c.template=c.options.templates.add;var a=angular.element(e[0].querySelector(".tableRows .tableBody"));k(a)},c.editRow=function(a,b){c.checkEvent(a)&&(q={oper:c.config.OPER_EDIT,dataOld:b,dataNew:angular.copy(b)},m(c.config.OPER_PHASE_BEGIN),c.template=c.options.templates.edit,k(j(a)))},c.deleteRow=function(a,b){c.checkEvent(a)&&(q={oper:c.config.OPER_DELETE,dataOld:b,dataNew:{}},m(c.config.OPER_PHASE_BEGIN),c.template=c.options.templates["delete"],k(j(a)))},c.viewRow=function(a,b){c.checkEvent(a)&&(q={oper:c.config.OPER_VIEW,dataOld:b,dataNew:{}},m(c.config.OPER_PHASE_BEGIN),c.template=c.options.templates.view,k(j(a)))},c.acceptClicked=function(){l(),m(c.config.OPER_PHASE_END),!c.extDataPagination&&d.isEqual(q.oper,c.config.OPER_EDIT)?c.execFilter():c.extDataPagination&&!d.isEqual(q.oper,c.config.OPER_VIEW)&&c.paginationOperation(q.oper),g(q.dataOld)},c.cancelClicked=function(){l()},c.notifyRowSelect=function(a,b){d.isUndefined(c.options.row.rowSelectCb)||c.options.row.rowSelectCb(a,b)},c.$on(c.config.SET_EXT_PAGINATION_DATA_EVENT,function(a,b){c.filteredItems=b.data,c.totalCount=b.totalCount,d.isEqual(o,c.config.EXT_BTN)||d.isEqual(o,c.config.OPER_EDIT)||d.isEqual(o,c.config.EXT_SORT)||d.paginatorEvent(c),c.options.busyIcon.visible&&(c.busyIcon=!1)}),c.getColumns=function(){return c.options.columns},c.getOperationDataObject=function(){return d.isEqual(q.oper,c.config.OPER_ADD)||d.isEqual(q.oper,c.config.OPER_EDIT)?{oper:q.oper,data:q.dataNew}:{oper:q.oper,data:q.dataOld}},c.getPropertyValue=function(a,b){if(d.isEqual(b.indexOf(c.config.DOT_SEPARATOR),-1))return a[b];var e=b.split(c.config.DOT_SEPARATOR),f=angular.copy(a);return angular.forEach(e,function(a){f=f[a]}),f},c.getColumnStyle=function(a,b){if(!d.isUndefined(b.rules)){var e="";for(var f in b.rules){var g=c.getPropertyValue(a,b.rules[f].prop),h=angular.copy(b.rules[f].expression.toString());if(h=h.split(b.rules[f].prop).join(g.toString()),c.$eval(h)){e=b.rules[f].style;break}}return e}},c.paginationOperation=function(a){c.extDataPagination&&(c.options.busyIcon.visible&&(c.busyIcon=!0),o=a,(d.isEqual(a,c.config.OPER_ADD)||d.isEqual(a,c.config.OPER_DELETE)||d.isEqual(a,c.config.EXT_FLT))&&(c.paginator.visiblePageIdx=0),(d.isEqual(a,c.config.OPER_ADD)||d.isEqual(a,c.config.OPER_DELETE))&&h(!1),c.options.data.extPaginationOperationCb({columnFilter:c.columnFilter,globalFilter:c.globalFilter,page:c.paginator.visiblePageIdx+1,pageSize:c.pageSize.rows,sort:c.sort}))},c.checkEvent=function(a){return(d.isEqual(a.which,1)||d.isEqual(a.which,13))&&!c.busyIcon};var s=e.on("click",function(a){1===a.which&&c.colTogglerShow&&(c.colTogglerShow=!1,c.$apply())});c.$on("$destroy",function(){d.isEqual(r,null)||r(),c.$off(c.config.SET_EXT_PAGINATION_DATA_EVENT),e.off("click",s)}),n()}}}]).directive("filterFocus",["$timeout",function(a){return{restrict:"A",scope:!1,link:function(b,c,d){b.$on(b.config.FILTER_FOCUS_EVENT,function(){a(function(){c[0].focus()})}),b.$on("$destroy",function(){b.$off(b.config.FILTER_FOCUS_EVENT)})}}}]).directive("colFilterTemplate",["$compile","vsdtServ",function(a,b){return{restrict:"A",scope:!1,link:function(c,d,e){function f(){var f=c.$eval(e.colFilterTemplate);if(!b.isUndefined(f.filter)&&!b.isUndefined(f.filter.template)&&!b.isUndefined(f.filter.match)){var g=angular.copy(f.filter.template);g=g.replace(c.config.COLUMN_PROP_VALUE,"columnFilter"+c.config.DOT_SEPARATOR+f.filter.match+c.config.DOT_SEPARATOR+f.prop+'"');var h=angular.element(g);a(h)(c),d.append(h)}}f()}}}]).directive("tableBodyRow",["vsdtServ",function(a){return{restrict:"A",scope:!1,link:function(b,c,d){function e(c){return(a.isEqual(c.which,1)||a.isEqual(c.which,13))&&(1===b.options.row.selection||2===b.options.row.selection)}function f(){c.addClass("hoverRow")}function g(){c.removeClass("hoverRow")}function h(){b.options.row.hover&&(c.on("mouseenter",f),c.on("mouseleave",g))}b.rowClicked=function(c,d){if(e(c)){var f=b.config.ROW_SELECT,g=b.selectedRows.indexOf(d);1===b.options.row.selection&&a.isEqual(g,-1)?(b.selectedRows.length>0&&b.notifyRowSelect(b.config.ROW_DESELECT,b.selectedRows[0]),b.selectedRows[0]=d):1!==b.options.row.selection||a.isEqual(g,-1)?2===b.options.row.selection&&a.isEqual(g,-1)?b.selectedRows.push(d):2!==b.options.row.selection||a.isEqual(g,-1)||(b.selectedRows.splice(g,1),f=b.config.ROW_DESELECT):(b.selectedRows.splice(0,1),f=b.config.ROW_DESELECT),b.notifyRowSelect(f,d)}},b.isRowSelected=function(c){return!a.isEqual(b.selectedRows.indexOf(c),-1)},b.$on("$destroy",function(){b.options.row.hover&&(c.off("mouseenter",f),c.off("mouseleave",g))}),h()}}}]).directive("tablePaginator",["vsdtServ",function(a){return{restrict:"A",scope:!1,templateUrl:"templates/vspaginator.html",link:function(b,c,d){function e(c){a.isEqual(c,b.btnFirst)?g(0,c):a.isEqual(c,b.btnPrev)?a.isEqual(b.paginator.visiblePageIdx-b.paginator.pageFirstIdx,0)?g(b.paginator.visiblePageIdx-p,c):h(b.paginator.visiblePageIdx-1,b.paginator.pageFirstIdx):a.isEqual(c,b.btnPrevSet)?g(b.paginator.pageFirstIdx-p,c):a.isEqual(c,b.btnLast)?g(b.totalPages-1,c):a.isEqual(c,b.btnNext)?a.isEqual(b.paginator.visiblePageIdx-b.paginator.pageFirstIdx,p-1)?g(b.paginator.pageFirstIdx+p,c):h(b.paginator.visiblePageIdx+1,b.paginator.pageFirstIdx):a.isEqual(c,b.btnNextSet)&&g(b.paginator.pageFirstIdx+p,c)}function f(a){b.totalPages=Math.ceil(a/b.pageSize.rows)}function g(c,d){var e=0,f=0;if(c>b.paginator.visiblePageIdx)if(e=c,a.isEqual(d,b.btnLast))f=e-p+1;else{var g=i(c);f=a.isEqual(g,c)?c:g}else if(c<b.paginator.visiblePageIdx&&!a.isEqual(d,b.btnFirst)){var g=j(c);e=c+p-1,f=a.isEqual(g,c)?c:g}h(e,f)}function h(a,c){b.paginator={visiblePageIdx:a,pageFirstIdx:c},k()}function i(a){return a+p>b.totalPages?b.totalPages-p:a}function j(a){return 0>a?0:a}function k(){p=b.totalPages>o?o:b.totalPages;var a=b.paginator.visiblePageIdx!==b.paginator.pageFirstIdx?b.paginator.pageFirstIdx:b.paginator.visiblePageIdx;b.paginatorButtons.length=0,b.options.paginator.firstLastBtn.visible&&b.paginatorButtons.push(b.btnFirst),b.options.paginator.prevNextBtn.visible&&b.paginatorButtons.push(b.btnPrev),b.options.paginator.prevNextSetBtn.visible&&b.paginatorButtons.push(b.btnPrevSet);for(var c=a;p+a>c;c++)b.paginatorButtons.push({id:c+1,label:c+1});b.options.paginator.prevNextSetBtn.visible&&b.paginatorButtons.push(b.btnNextSet),b.options.paginator.prevNextBtn.visible&&b.paginatorButtons.push(b.btnNext),b.options.paginator.firstLastBtn.visible&&b.paginatorButtons.push(b.btnLast),l()}function l(){b.disabledButtons.length=0,a.isEqual(b.paginator.visiblePageIdx,0)&&(b.disabledButtons.push(b.btnFirst),b.disabledButtons.push(b.btnPrev)),a.isEqual(b.paginator.pageFirstIdx,0)&&b.disabledButtons.push(b.btnPrevSet),b.paginator.pageFirstIdx+p>=b.totalPages&&b.disabledButtons.push(b.btnNextSet),b.paginator.visiblePageIdx>=b.totalPages-1&&(b.disabledButtons.push(b.btnLast),b.disabledButtons.push(b.btnNext))}function m(){f(b.totalCount),h(0,0)}function n(){b.btnPrev={id:"b",label:b.options.paginator.prevNextBtn.labels[0]},b.btnNext={id:"n",label:b.options.paginator.prevNextBtn.labels[1]},b.btnFirst={id:"f",label:b.options.paginator.firstLastBtn.labels[0]},b.btnLast={id:"l",label:b.options.paginator.firstLastBtn.labels[1]},b.btnPrevSet={id:"ps",label:b.options.paginator.prevNextSetBtn.labels[0]},b.btnNextSet={id:"ns",label:b.options.paginator.prevNextSetBtn.labels[1]},b.pageSizeOptions=b.options.paginator.pageSizeOptions,o=b.options.paginator.numberBtnCount>b.config.PAGINATOR_MAX_BTN_COUNT?b.config.PAGINATOR_MAX_BTN_COUNT:b.options.paginator.numberBtnCount;var a=0;for(var c in b.pageSizeOptions)if(b.pageSizeOptions[c].hasOwnProperty("default")&&angular.equals(b.pageSizeOptions[c]["default"],!0)){a=c;break}b.pageSize=b.pageSizeOptions[a],m()}b.paginator={visiblePageIdx:0,pageFirstIdx:0},b.paginatorButtons=[],b.disabledButtons=[];var o=0,p=0;b.pageSizeButtonClick=function(a){b.pageSize=b.pageSizeOptions[b.pageSizeOptions.indexOf(a)],m(),b.extDataPagination&&b.paginationOperation(b.config.EXT_BTN)},b.paginatorBtnClick=function(a,c){b.isDisabledBtn(a)||(b.isNavigateBtn(a)?e(a):h(a.id-1,b.paginator.pageFirstIdx,c-2),b.extDataPagination&&b.paginationOperation(b.config.EXT_BTN))},b.isNavigateBtn=function(c){return a.isEqual(c,b.btnFirst)||a.isEqual(c,b.btnPrev)||a.isEqual(c,b.btnPrevSet)||a.isEqual(c,b.btnNext)||a.isEqual(c,b.btnNextSet)||a.isEqual(c,b.btnLast)},b.isDisabledBtn=function(c){return b.isNavigateBtn(c)&&!a.isEqual(b.disabledButtons.indexOf(c),-1)},b.$on(b.config.PAGINATOR_EVENT,function(){m()}),b.$on("$destroy",function(){b.$off(b.config.PAGINATOR_EVENT)}),n()}}}]).directive("colToggleMenu",function(){return{restrict:"A",scope:!1,templateUrl:"templates/vscoltogglemenu.html",link:function(a,b,c){a.colTogglerShowClicked=function(b){a.checkEvent(b)&&(a.colTogglerShow=!a.colTogglerShow)},a.colToggleMenuClicked=function(b,c){a.checkEvent(b)&&(a.visibleColCount=c.visible?a.visibleColCount-1:a.visibleColCount+1,c.visible=!c.visible,a.colInitDone=!0)}}}}).directive("captionBar",["$filter","vsdtServ",function(a,b){return{restrict:"A",scope:!1,templateUrl:"templates/vscaption.html",link:function(c,d,e){function f(a){for(var d in c.options.columns)if(b.isEqual(c.options.columns[d].prop,a))return c.options.columns[d].filter.dateFormat}function g(a,b){b=b.toLowerCase();var d=b.indexOf(c.config.YEAR),e=b.indexOf(c.config.MONTH),f=b.indexOf(c.config.DAY);return new Date(parseInt(a.substring(d,d+4)),parseInt(a.substring(e,e+2))-1,parseInt(a.substring(f,f+2)))}function h(a){var c={};return angular.forEach(a,function(a,d){b.isEqual(a,"")||(c[d]=a)}),c}function i(){b.isEqual(c.sort.col,"")||(c.filteredItems=q(c.filteredItems,c.sort.col,c.sort.reverse))}function j(a,d){b.isObject(a)&&b.isEqual(d.contain,{})&&b.isEqual(d.exact,{})||(!b.isEqual(a,d)&&t&&c.execFilterAndSort(),t=!0)}function k(a,d){!b.isEqual(a,d)&&a&&b.setFilterFocus(c)}function l(){var a="";return angular.forEach(c.options.columns,function(d){b.isUndefined(d.filter)||b.isUndefined(d.filter.template)||(a+="columnFilter."+d.filter.match+c.config.DOT_SEPARATOR+d.prop+" + ")}),a}function m(a){angular.forEach(a,function(b,c){a[c]=""})}function n(){if(c.options.filter.global||c.options.filter.column){var a=l();c.options.filter.autoFilter.useAutoFilter&&(a+="globalFilter",o=c.$watch(a,j))}c.options.filter.global&&(p=c.$watch("filterFocus",k))}c.filterFocus=!1;var o=null,p=null,q=a("orderBy"),r=a("filter"),s=a("dateRangeFilter"),t=!0;c.filterBtnClick=function(a){c.checkEvent(a)&&(c.filterFocus=!c.filterFocus,c.filterFocus||c.resetFilter(!0))},c.execFilterAndSort=function(){c.extDataPagination?c.paginationOperation(c.config.EXT_FLT):(c.execFilter(),i(),b.paginatorEvent(c))},c.resetFilter=function(a){t=a,c.globalFilter="",m(c.columnFilter.contain),m(c.columnFilter.exact),m(c.columnFilter.daterange),!c.options.filter.autoFilter.useAutoFilter&&a&&c.execFilterAndSort()},c.sortByCol=function(a,d){a.stopPropagation(),c.checkEvent(a)&&(b.isEqual(c.sort.col,d)?c.sort.reverse=!c.sort.reverse:c.sort.reverse=!1,c.sort.col=d,c.extDataPagination||(b.isEqual(d,"")&&c.execFilter(),i()),c.paginationOperation(c.config.EXT_SORT))},c.execFilter=function(){c.filteredItems=c.options.data.items,b.isEqual(c.globalFilter,"")||(c.filteredItems=r(c.filteredItems,c.globalFilter));var a=h(c.columnFilter.contain);b.isEqual(a,{})||(c.filteredItems=r(c.filteredItems,a));var d=h(c.columnFilter.exact);b.isEqual(d,{})||(c.filteredItems=r(c.filteredItems,d,function(a,c){return b.isEqual(a.toString(),c)||b.isEqual(c,"")}));var e=h(c.columnFilter.daterange);b.isEqual(e,{})||angular.forEach(e,function(a,d){var e=a.split(c.config.DATES_SEPARATOR);if(b.isEqual(e.length,2)&&b.isEqual(e[0].length,10)&&b.isEqual(e[1].length,10)){var h=f(d);c.filteredItems=s(c.filteredItems,d,g(e[0],h),g(e[1],h))}}),c.totalCount=c.filteredItems.length},c.$on("$destroy",function(){b.isEqual(o,null)||o(),b.isEqual(p,null)||p()}),n()}}}]).filter("dateRangeFilter",function(){return function(a,b,c,d){var e=[];return angular.forEach(a,function(a){var f=new Date(a[b]);f>=c&&d>=f&&e.push(a)}),e}}).directive("overlayWindow",["$compile","$timeout","vsdtServ",function(a,b,c){return{restrict:"A",scope:!1,link:function(d,e,f){function g(){e[0].scrollWidth>e[0].offsetWidth&&(l=b(function(){c.getTemplate("datatableoverlaywindow.html").then(function(b){k=angular.element(b.data),k.css("margin-top","-20px"),k.css("margin-left","14px"),k.text(f.overlayWindow),e.append(a(k)(d))})},d.config.OVERLAY_SHOW_DELAY))}function h(){i(),angular.equals(k,null)||(k.remove(),k=null)}function i(){b.cancel(l),l=null}function j(){d.options.showOverlay&&(e.on("mouseenter",g),e.on("mouseleave",h))}var k=null,l=null;d.closeOverlay=function(a){a.stopPropagation(),h()},d.$on("$destroy",function(){e.off("mouseenter",g),e.off("mouseleave",h)}),j()}}}]).directive("vstooltip",["$compile","$timeout","vsdtServ",function(a,b,c){return{restrict:"A",scope:!1,link:function(d,e,f){function g(){n=b(function(){i(),o=b(function(){j()},d.config.TOOLTIP_CLOSE_DELAY,!0)},d.config.TOOLTIP_SHOW_DELAY,!0)}function h(){k(),j()}function i(){c.getTemplate("datatabletooltip.html").then(function(b){m=angular.element(b.data),m.css("margin-left",e.prop("offsetLeft")+"px"),m.text(f.vstooltip),e.append(a(m)(d))})}function j(){angular.equals(m,null)||(m.remove(),m=null)}function k(){b.cancel(n),b.cancel(o)}function l(){d.options.showTooltips&&(e.on("mouseenter",g),e.on("mouseleave",h))}var m=null,n=null,o=null;d.$on("$destroy",function(){e.off("mouseenter",g),e.off("mouseleave",h)}),l()}}}]).directive("colResizer",["$compile","$document","vsdtServ",function(a,b,c){return{restrict:"A",scope:!1,link:function(d,e,f){function g(a){a.preventDefault(),n=a.clientX,o=e.next(),c.isEqual(o.prop("id"),"headerColAction")||(p=e.prop("offsetWidth"),q=o.prop("offsetWidth"),r=e.parent().prop("offsetWidth"),b.on("mousemove",h),b.on("mouseup",i),j("col-resize"))}function h(a){var b=a.clientX-n,c=p+b,f=q-b;b>0&&f<d.config.COL_RESIZER_MIN_COL_WIDTH||0>b&&c<d.config.COL_RESIZER_MIN_COL_WIDTH||(e.css("width",c/r*100+"%"),o.css("width",f/r*100+"%"))}function i(){b.off("mousemove",h),b.off("mouseup",i),j("default")}function j(a){b.prop("body").style.cursor=a}function k(){var a=100-d.config.DEFAULT_ACTION_COL_WIDTH/e.parent().prop("offsetWidth")*100;return a/d.visibleColCount}function l(){var a=k();angular.forEach(d.options.columns,function(b){b.visible&&(b.width={number:a,unit:"%"})})}function m(){d.options.columnResize&&c.getTemplate("datatablecolresizer.html").then(function(b){s=angular.element(b.data),s.on("mousedown",g),e.css("background-clip","padding-box"),e.css("position","relative"),e.append(a(s)(d))}),d.colInitDone&&l()}var n=0,o=0,p=0,q=0,r=0,s=null;d.$on("$destroy",function(){s.off("mousedown",g),l()}),m()}}}]);